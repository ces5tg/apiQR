{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nvar userService = {\n  apiUrl: 'http://172.22.141.245:3000/api/auth',\n  login: function () {\n    var _login = _asyncToGenerator(function* (username, password) {\n      try {\n        var response = yield fetch(`${userService.apiUrl}/login`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            username: username,\n            password: password\n          })\n        });\n        var data = yield response.json();\n        if (!response.ok) {\n          throw new Error(data.message || 'Error al iniciar sesión');\n        }\n        if (!data.token) {\n          console.error('Respuesta del servidor:', data);\n          throw new Error('No se recibió un token después del inicio de sesión');\n        }\n        yield AsyncStorage.setItem('authToken', data.token);\n        return data.token;\n      } catch (error) {\n        console.error('Error al iniciar sesión:', error);\n        throw error;\n      }\n    });\n    function login(_x, _x2) {\n      return _login.apply(this, arguments);\n    }\n    return login;\n  }(),\n  register: function () {\n    var _register = _asyncToGenerator(function* (username, password) {\n      try {\n        console.log('Registrando usuario:', username);\n        var response = yield fetch(`${userService.apiUrl}/register`, {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            username: username,\n            password: password\n          })\n        });\n        var data = yield response.json();\n        console.log('Respuesta del servidor:', data);\n        return data;\n      } catch (error) {\n        throw new Error('Error al registrar');\n      }\n    });\n    function register(_x3, _x4) {\n      return _register.apply(this, arguments);\n    }\n    return register;\n  }(),\n  logout: function () {\n    var _logout = _asyncToGenerator(function* () {\n      try {\n        yield AsyncStorage.removeItem('authToken');\n      } catch (error) {\n        throw new Error('Error al cerrar sesión');\n      }\n    });\n    function logout() {\n      return _logout.apply(this, arguments);\n    }\n    return logout;\n  }(),\n  isLoggedIn: function () {\n    var _isLoggedIn = _asyncToGenerator(function* () {\n      try {\n        var token = yield AsyncStorage.getItem('authToken');\n        return !!token;\n      } catch (error) {\n        throw new Error('Error al verificar el estado de inicio de sesión');\n      }\n    });\n    function isLoggedIn() {\n      return _isLoggedIn.apply(this, arguments);\n    }\n    return isLoggedIn;\n  }()\n};\nexport default userService;","map":{"version":3,"names":["AsyncStorage","userService","apiUrl","login","_login","_asyncToGenerator","username","password","response","fetch","method","headers","body","JSON","stringify","data","json","ok","Error","message","token","console","error","setItem","_x","_x2","apply","arguments","register","_register","log","_x3","_x4","logout","_logout","removeItem","isLoggedIn","_isLoggedIn","getItem"],"sources":["D:/5 CICLO-II/movil/apiQR/services/userService.js"],"sourcesContent":["import AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\nconst userService = {\r\n  apiUrl: 'http://172.22.141.245:3000/api/auth', // Cambiar por la IP de tu computadora OJO con el puerto\r\n\r\n  login: async (username, password) => {\r\n    try {\r\n      const response = await fetch(`${userService.apiUrl}/login`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ username, password }),\r\n      });\r\n      const data = await response.json();\r\n    \r\n      if (!response.ok) {\r\n        throw new Error(data.message || 'Error al iniciar sesión');\r\n      }\r\n    \r\n      if (!data.token) {\r\n        console.error('Respuesta del servidor:', data);\r\n        throw new Error('No se recibió un token después del inicio de sesión');\r\n      }\r\n    \r\n      await AsyncStorage.setItem('authToken', data.token);\r\n      return data.token;\r\n    } catch (error) {\r\n      console.error('Error al iniciar sesión:', error);\r\n      throw error;\r\n    }    \r\n  },\r\n  \r\n  \r\n  \r\n\r\n  register: async (username, password) => {\r\n    try {\r\n      console.log('Registrando usuario:', username);\r\n      // Realiza la solicitud al servidor para registrar el usuario y guarda la respuesta\r\n      const response = await fetch(`${userService.apiUrl}/register`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify({ username, password }),\r\n      });\r\n      const data = await response.json();\r\n      console.log('Respuesta del servidor:', data);\r\n      // Aquí podrías usar un sistema de notificaciones o mensajes para mostrar que el registro fue exitoso\r\n      return data;\r\n    } catch (error) {\r\n      throw new Error('Error al registrar');\r\n    }\r\n  },\r\n\r\n  logout: async () => {\r\n    try {\r\n      await AsyncStorage.removeItem('authToken');\r\n    } catch (error) {\r\n      throw new Error('Error al cerrar sesión');\r\n    }\r\n  },\r\n\r\n  isLoggedIn: async () => {\r\n    try {\r\n      const token = await AsyncStorage.getItem('authToken');\r\n      return !!token;\r\n    } catch (error) {\r\n      throw new Error('Error al verificar el estado de inicio de sesión');\r\n    }\r\n  },\r\n};\r\n\r\nexport default userService;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}